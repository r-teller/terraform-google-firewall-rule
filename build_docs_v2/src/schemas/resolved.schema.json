{
  "$id": "firewall_rules.schema.json",
  "title": "Firewall Rules v3",
  "type": "array",
  "uniqueItems": true,
  "widget": "GenericList",
  "items": {
    "type": "object",
    "title": "Firewall Rule",
    "properties": {
      "direction": {
        "title": "Rule Direction",
        "description": "The direction of traffic to which this rule applies. Can be ingress (incoming traffic) or egress (outgoing traffic).",
        "type": "string",
        "widget": "Select",
        "oneOf": [
          {
            "const": "INGRESS",
            "description": "Incoming traffic direction.",
            "title": "Ingress"
          },
          {
            "const": "EGRESS",
            "description": "Outgoing traffic direction.",
            "title": "Egress"
          }
        ],
        "default": "INGRESS"
      },
      "action": {
        "title": "Rule Action",
        "description": "Defines whether the rule allows or denies traffic.",
        "type": "string",
        "widget": "Select",
        "oneOf": [
          {
            "const": "ALLOW",
            "description": "Allow the traffic.",
            "title": "Allow"
          },
          {
            "const": "DENY",
            "description": "Deny the traffic.",
            "title": "Deny"
          }
        ],
        "default": "ALLOW",
        "examples": [
          "ALLOW",
          "DENY"
        ]
      },
      "description": {
        "title": "Description",
        "type": "string",
        "description": "A detailed description of the rule.",
        "examples": [
          "This rule allows traffic from specific IP ranges."
        ]
      },
      "name": {
        "title": "Firewall Rule Name",
        "type": "string",
        "description": "The name of the firewall rule. If not specified, it will be based on the id field.",
        "pattern": "^(?:[a-z](?:[-a-z0-9]{0,61}[a-z0-9])?)$",
        "minLength": 1,
        "maxLength": 63,
        "examples": [
          "<prefix>-<environment>-<network>-firewall-<id>"
        ]
      },
      "id": {
        "title": "Rule ID",
        "type": "string",
        "description": "A unique identifier for the rule. If not specified, the name will be based on this field.",
        "pattern": "^[a-z][a-z0-9-]{0,23}$",
        "minLength": 1,
        "maxLength": 24,
        "examples": [
          "example-rule-id-allow-tcp-443"
        ]
      },
      "network": {
        "title": "Network (VPC)",
        "type": "string",
        "description": "The network to apply the rule to.",
        "examples": [
          "default-vpc"
        ]
      },
      "environment": {
        "title": "Environment",
        "type": "string",
        "description": "The environment to apply the rule to.",
        "examples": [
          "prod",
          "dev",
          "stage"
        ]
      },
      "prefix": {
        "title": "Prefix",
        "type": "string",
        "description": "The prefix to apply to the rule when generating a dynamic name.",
        "examples": [
          "fw-rule"
        ]
      },
      "sources": {
        "title": "Sources",
        "type": "array",
        "description": "List of source specifications for the firewall rule. Can be an IP CIDR range, a tag, or a service account email.",
        "widget": "GenericList",
        "items": {
          "type": "string",
          "oneOf": [
            {
              "title": "IP CIDR Range",
              "type": "string",
              "description": "IP space allocated to this subnetwork in CIDR format.",
              "examples": [
                "192.168.0.0/24"
              ],
              "pattern": "^(?:([0-9]|[1-9][0-9]{0,1}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5])(\\.([0-9]|[1-9][0-9]{0,1}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5])){3}/(([0-9]|[1-2][0-9]|3[0-2])))$"
            },
            {
              "title": "Tag",
              "type": "string",
              "description": "Strings added to a tags field in a resource, such as Compute Engine virtual machine (VM) instances or instance templates. Tags enable you to make firewall rules and routes applicable to specific VM instances.",
              "pattern": "^(?:[a-z](?:[-a-z0-9]{0,61}[a-z0-9])?)$",
              "maxLength": 63,
              "examples": [
                "alpha-tag",
                "bravo-tag",
                "charlie-tag",
                "web-server",
                "database"
              ]
            },
            {
              "title": "Service Account",
              "description": "The email address of a service account. Firewall rules can target or be applied based on service accounts.",
              "type": "string",
              "pattern": "^\\S+@\\S+\\.\\S+$",
              "maxLength": 63,
              "examples": [
                "project-number-compute@developer.gserviceaccount.com",
                "project-id@appspot.gserviceaccount.com",
                "project-number@cloudservices.gserviceaccount.com"
              ]
            }
          ]
        },
        "default": [],
        "minItems": 0,
        "examples": [
          "192.168.1.0/24",
          "example-tag",
          "example-service-account@example.com"
        ]
      },
      "targets": {
        "title": "Targets",
        "type": "array",
        "description": "List of target specifications for the firewall rule. Can be an IP CIDR range, a tag, or a service account email.",
        "widget": "GenericList",
        "items": {
          "type": "string",
          "oneOf": [
            {
              "title": "IP CIDR Range",
              "type": "string",
              "description": "IP space allocated to this subnetwork in CIDR format.",
              "examples": [
                "192.168.0.0/24"
              ],
              "pattern": "^(?:([0-9]|[1-9][0-9]{0,1}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5])(\\.([0-9]|[1-9][0-9]{0,1}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5])){3}/(([0-9]|[1-2][0-9]|3[0-2])))$"
            },
            {
              "title": "Tag",
              "type": "string",
              "description": "Strings added to a tags field in a resource, such as Compute Engine virtual machine (VM) instances or instance templates. Tags enable you to make firewall rules and routes applicable to specific VM instances.",
              "pattern": "^(?:[a-z](?:[-a-z0-9]{0,61}[a-z0-9])?)$",
              "maxLength": 63,
              "examples": [
                "alpha-tag",
                "bravo-tag",
                "charlie-tag",
                "web-server",
                "database"
              ]
            },
            {
              "title": "Service Account",
              "description": "The email address of a service account. Firewall rules can target or be applied based on service accounts.",
              "type": "string",
              "pattern": "^\\S+@\\S+\\.\\S+$",
              "maxLength": 63,
              "examples": [
                "project-number-compute@developer.gserviceaccount.com",
                "project-id@appspot.gserviceaccount.com",
                "project-number@cloudservices.gserviceaccount.com"
              ]
            }
          ]
        },
        "default": [],
        "minItems": 0,
        "examples": [
          "192.168.1.0/24",
          "example-tag",
          "example-service-account@example.com"
        ]
      },
      "rules": {
        "title": "Rules List",
        "description": "A list of individual rules that define the behavior of the firewall rule based on specified conditions.",
        "type": "array",
        "widget": "SimpleList",
        "uniqueItems": true,
        "minItems": 1,
        "items": {
          "title": "Firewall Rule",
          "type": "object",
          "properties": {
            "protocol": {
              "title": "IP Protocol",
              "description": "The IP protocol to which this rule applies. The value can be TCP, UDP, ICMP, or ALL.",
              "type": "string",
              "widget": "Select",
              "enum": [
                "ALL",
                "AH",
                "ESP",
                "ICMP",
                "IPIP",
                "SCTP",
                "TCP",
                "UDP"
              ],
              "default": "TCP",
              "examples": [
                "TCP",
                "UDP",
                "ICMP"
              ]
            }
          },
          "required": [
            "protocol"
          ],
          "allOf": [
            {
              "if": {
                "properties": {
                  "protocol": {
                    "type": "string",
                    "pattern": "^(TCP|UDP)$"
                  }
                },
                "required": [
                  "protocol"
                ]
              },
              "then": {
                "type": "object",
                "title": "TCP/UDP Rule",
                "additionalProperties": false,
                "properties": {
                  "protocol": {
                    "title": "IP Protocol",
                    "description": "The IP protocol to which this rule applies. The value can be TCP, UDP, ICMP, or ALL.",
                    "type": "string",
                    "widget": "Select",
                    "enum": [
                      "ALL",
                      "AH",
                      "ESP",
                      "ICMP",
                      "IPIP",
                      "SCTP",
                      "TCP",
                      "UDP"
                    ],
                    "default": "TCP",
                    "examples": [
                      "TCP",
                      "UDP",
                      "ICMP"
                    ]
                  },
                  "ports": {
                    "title": "Ports",
                    "type": "array",
                    "widget": "GenericList",
                    "items": {
                      "type": "string",
                      "oneOf": [
                        {
                          "title": "Port Range",
                          "pattern": "^(0|6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})-(6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})$"
                        },
                        {
                          "title": "Port",
                          "pattern": "^(0|6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})$"
                        }
                      ]
                    },
                    "default": [],
                    "minItems": 0
                  }
                }
              }
            },
            {
              "if": {
                "properties": {
                  "protocol": {
                    "type": "string",
                    "pattern": "^(ALL|ICMP|ESP|AH|SCTP|IPIP)$"
                  }
                },
                "required": [
                  "protocol"
                ]
              },
              "then": {
                "type": "object",
                "title": "Other Named Protocol Rule",
                "additionalProperties": false,
                "required": [
                  "protocol"
                ],
                "properties": {
                  "protocol": {
                    "title": "IP Protocol",
                    "description": "The IP protocol to which this rule applies. The value can be TCP, UDP, ICMP, or ALL.",
                    "type": "string",
                    "widget": "Select",
                    "enum": [
                      "ALL",
                      "AH",
                      "ESP",
                      "ICMP",
                      "IPIP",
                      "SCTP",
                      "TCP",
                      "UDP"
                    ],
                    "default": "TCP",
                    "examples": [
                      "TCP",
                      "UDP",
                      "ICMP"
                    ]
                  },
                  "ports": {
                    "type": "array",
                    "widget": "GenericList",
                    "items": {
                      "type": "string",
                      "deleteOnEmpty": true,
                      "maxLength": 0,
                      "pattern": "^(?!.*)"
                    },
                    "maxItems": 0
                  }
                }
              }
            }
          ]
        },
        "examples": [
          {
            "protocol": "TCP",
            "ports": [
              "80",
              "443"
            ]
          }
        ]
      },
      "disabled": {
        "title": "Disable Firewall Rule",
        "type": "boolean",
        "description": "Indicates if the rule is disabled.",
        "default": false,
        "examples": [
          true,
          false
        ]
      },
      "priority": {
        "title": "Priority",
        "description": "The priority of the rule. Lower values indicate higher priority.",
        "type": "integer",
        "minimum": 0,
        "maximum": 65535,
        "default": 1000,
        "examples": [
          1000,
          2000
        ]
      },
      "log_config": {
        "title": "Log Configuration",
        "description": "Defines how traffic that matches this rule should be logged.",
        "type": "string",
        "oneOf": [
          {
            "const": "EXCLUDE_ALL_METADATA",
            "description": "Exclude all metadata from the logs.",
            "title": "Exclude All Metadata"
          },
          {
            "const": "INCLUDE_ALL_METADATA",
            "description": "Include all metadata in the logs.",
            "title": "Include All Metadata"
          },
          {
            "const": "DISABLED",
            "description": "Disable logging for this rule.",
            "title": "Disabled"
          }
        ],
        "default": "DISABLED",
        "examples": [
          "EXCLUDE_ALL_METADATA",
          "INCLUDE_ALL_METADATA",
          "DISABLED"
        ]
      }
    },
    "required": [
      "direction",
      "action",
      "rules",
      "sources",
      "targets"
    ]
  },
  "definitions": {
    "shared": {
      "properties": {
        "action": {
          "title": "Rule Action",
          "description": "Defines whether the rule allows or denies traffic.",
          "type": "string",
          "widget": "Select",
          "oneOf": [
            {
              "const": "ALLOW",
              "description": "Allow the traffic.",
              "title": "Allow"
            },
            {
              "const": "DENY",
              "description": "Deny the traffic.",
              "title": "Deny"
            }
          ],
          "default": "ALLOW",
          "examples": [
            "ALLOW",
            "DENY"
          ]
        },
        "direction": {
          "title": "Rule Direction",
          "description": "The direction of traffic to which this rule applies. Can be ingress (incoming traffic) or egress (outgoing traffic).",
          "type": "string",
          "widget": "Select",
          "oneOf": [
            {
              "const": "INGRESS",
              "description": "Incoming traffic direction.",
              "title": "Ingress"
            },
            {
              "const": "EGRESS",
              "description": "Outgoing traffic direction.",
              "title": "Egress"
            }
          ],
          "default": "INGRESS",
          "examples": [
            "INGRESS",
            "EGRESS"
          ]
        },
        "log_config": {
          "title": "Log Configuration",
          "description": "Defines how traffic that matches this rule should be logged.",
          "type": "string",
          "oneOf": [
            {
              "const": "EXCLUDE_ALL_METADATA",
              "description": "Exclude all metadata from the logs.",
              "title": "Exclude All Metadata"
            },
            {
              "const": "INCLUDE_ALL_METADATA",
              "description": "Include all metadata in the logs.",
              "title": "Include All Metadata"
            },
            {
              "const": "DISABLED",
              "description": "Disable logging for this rule.",
              "title": "Disabled"
            }
          ],
          "default": "DISABLED",
          "examples": [
            "EXCLUDE_ALL_METADATA",
            "INCLUDE_ALL_METADATA",
            "DISABLED"
          ]
        },
        "disabled": {
          "title": "Disable Firewall Rule",
          "type": "boolean",
          "description": "Indicates if the rule is disabled.",
          "default": false,
          "examples": [
            true,
            false
          ]
        },
        "id": {
          "title": "Rule ID",
          "type": "string",
          "description": "A unique identifier for the rule. If not specified, the name will be based on this field.",
          "pattern": "^[a-z][a-z0-9-]{0,23}$",
          "minLength": 1,
          "maxLength": 24,
          "examples": [
            "example-rule-id-allow-tcp-443"
          ]
        },
        "network": {
          "title": "Network (VPC)",
          "type": "string",
          "description": "The network to apply the rule to.",
          "examples": [
            "default-vpc"
          ]
        },
        "environment": {
          "title": "Environment",
          "type": "string",
          "description": "The environment to apply the rule to.",
          "examples": [
            "prod",
            "dev",
            "stage"
          ]
        },
        "ip_cidr_range": {
          "title": "IP CIDR Range",
          "type": "string",
          "description": "IP space allocated to this subnetwork in CIDR format.",
          "examples": [
            "192.168.0.0/24"
          ],
          "pattern": "^(?:([0-9]|[1-9][0-9]{0,1}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5])(\\.([0-9]|[1-9][0-9]{0,1}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5])){3}/(([0-9]|[1-2][0-9]|3[0-2])))$"
        },
        "name": {
          "title": "Firewall Rule Name",
          "type": "string",
          "description": "The name of the firewall rule. If not specified, it will be based on the id field.",
          "pattern": "^(?:[a-z](?:[-a-z0-9]{0,61}[a-z0-9])?)$",
          "minLength": 1,
          "maxLength": 63,
          "examples": [
            "<prefix>-<environment>-<network>-firewall-<id>"
          ]
        },
        "prefix": {
          "title": "Prefix",
          "type": "string",
          "description": "The prefix to apply to the rule when generating a dynamic name.",
          "examples": [
            "fw-rule"
          ]
        },
        "description": {
          "title": "Description",
          "type": "string",
          "description": "A detailed description of the rule.",
          "examples": [
            "This rule allows traffic from specific IP ranges."
          ]
        },
        "port_ranges": {
          "title": "Port Ranges",
          "description": "Ranges of ports to be either allowed or denied",
          "type": "array",
          "widget": "SimpleList",
          "uniqueItems": true,
          "items": {
            "type": "string",
            "pattern": "^(0|6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})(,(0|6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3}))*$",
            "examples": [
              "80-443",
              "8000-8080"
            ]
          }
        },
        "priority": {
          "title": "Priority",
          "description": "The priority of the rule. Lower values indicate higher priority.",
          "type": "integer",
          "minimum": 0,
          "maximum": 65535,
          "default": 1000,
          "examples": [
            1000,
            2000
          ]
        },
        "protocol": {
          "title": "IP Protocol",
          "description": "The IP protocol to which this rule applies. The value can be TCP, UDP, ICMP, or ALL.",
          "type": "string",
          "widget": "Select",
          "enum": [
            "ALL",
            "AH",
            "ESP",
            "ICMP",
            "IPIP",
            "SCTP",
            "TCP",
            "UDP"
          ],
          "default": "TCP",
          "examples": [
            "TCP",
            "UDP",
            "ICMP"
          ]
        },
        "rule": {
          "title": "Firewall Rule",
          "type": "object",
          "properties": {
            "protocol": {
              "title": "IP Protocol",
              "description": "The IP protocol to which this rule applies. The value can be TCP, UDP, ICMP, or ALL.",
              "type": "string",
              "widget": "Select",
              "enum": [
                "ALL",
                "AH",
                "ESP",
                "ICMP",
                "IPIP",
                "SCTP",
                "TCP",
                "UDP"
              ],
              "default": "TCP",
              "examples": [
                "TCP",
                "UDP",
                "ICMP"
              ]
            }
          },
          "required": [
            "protocol"
          ],
          "allOf": [
            {
              "if": {
                "properties": {
                  "protocol": {
                    "type": "string",
                    "pattern": "^(TCP|UDP)$"
                  }
                },
                "required": [
                  "protocol"
                ]
              },
              "then": {
                "type": "object",
                "title": "TCP/UDP Rule",
                "additionalProperties": false,
                "properties": {
                  "protocol": {
                    "title": "IP Protocol",
                    "description": "The IP protocol to which this rule applies. The value can be TCP, UDP, ICMP, or ALL.",
                    "type": "string",
                    "widget": "Select",
                    "enum": [
                      "ALL",
                      "AH",
                      "ESP",
                      "ICMP",
                      "IPIP",
                      "SCTP",
                      "TCP",
                      "UDP"
                    ],
                    "default": "TCP",
                    "examples": [
                      "TCP",
                      "UDP",
                      "ICMP"
                    ]
                  },
                  "ports": {
                    "title": "Ports",
                    "type": "array",
                    "widget": "GenericList",
                    "items": {
                      "type": "string",
                      "oneOf": [
                        {
                          "title": "Port Range",
                          "pattern": "^(0|6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})-(6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})$"
                        },
                        {
                          "title": "Port",
                          "pattern": "^(0|6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})$"
                        }
                      ]
                    },
                    "default": [],
                    "minItems": 0
                  }
                }
              }
            },
            {
              "if": {
                "properties": {
                  "protocol": {
                    "type": "string",
                    "pattern": "^(ALL|ICMP|ESP|AH|SCTP|IPIP)$"
                  }
                },
                "required": [
                  "protocol"
                ]
              },
              "then": {
                "type": "object",
                "title": "Other Named Protocol Rule",
                "additionalProperties": false,
                "required": [
                  "protocol"
                ],
                "properties": {
                  "protocol": {
                    "title": "IP Protocol",
                    "description": "The IP protocol to which this rule applies. The value can be TCP, UDP, ICMP, or ALL.",
                    "type": "string",
                    "widget": "Select",
                    "enum": [
                      "ALL",
                      "AH",
                      "ESP",
                      "ICMP",
                      "IPIP",
                      "SCTP",
                      "TCP",
                      "UDP"
                    ],
                    "default": "TCP",
                    "examples": [
                      "TCP",
                      "UDP",
                      "ICMP"
                    ]
                  },
                  "ports": {
                    "type": "array",
                    "widget": "GenericList",
                    "items": {
                      "type": "string",
                      "deleteOnEmpty": true,
                      "maxLength": 0,
                      "pattern": "^(?!.*)"
                    },
                    "maxItems": 0
                  }
                }
              }
            }
          ]
        },
        "rules": {
          "title": "Rules List",
          "description": "A list of individual rules that define the behavior of the firewall rule based on specified conditions.",
          "type": "array",
          "widget": "SimpleList",
          "uniqueItems": true,
          "minItems": 1,
          "items": {
            "title": "Firewall Rule",
            "type": "object",
            "properties": {
              "protocol": {
                "title": "IP Protocol",
                "description": "The IP protocol to which this rule applies. The value can be TCP, UDP, ICMP, or ALL.",
                "type": "string",
                "widget": "Select",
                "enum": [
                  "ALL",
                  "AH",
                  "ESP",
                  "ICMP",
                  "IPIP",
                  "SCTP",
                  "TCP",
                  "UDP"
                ],
                "default": "TCP",
                "examples": [
                  "TCP",
                  "UDP",
                  "ICMP"
                ]
              }
            },
            "required": [
              "protocol"
            ],
            "allOf": [
              {
                "if": {
                  "properties": {
                    "protocol": {
                      "type": "string",
                      "pattern": "^(TCP|UDP)$"
                    }
                  },
                  "required": [
                    "protocol"
                  ]
                },
                "then": {
                  "type": "object",
                  "title": "TCP/UDP Rule",
                  "additionalProperties": false,
                  "properties": {
                    "protocol": {
                      "title": "IP Protocol",
                      "description": "The IP protocol to which this rule applies. The value can be TCP, UDP, ICMP, or ALL.",
                      "type": "string",
                      "widget": "Select",
                      "enum": [
                        "ALL",
                        "AH",
                        "ESP",
                        "ICMP",
                        "IPIP",
                        "SCTP",
                        "TCP",
                        "UDP"
                      ],
                      "default": "TCP",
                      "examples": [
                        "TCP",
                        "UDP",
                        "ICMP"
                      ]
                    },
                    "ports": {
                      "title": "Ports",
                      "type": "array",
                      "widget": "GenericList",
                      "items": {
                        "type": "string",
                        "oneOf": [
                          {
                            "title": "Port Range",
                            "pattern": "^(0|6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})-(6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})$"
                          },
                          {
                            "title": "Port",
                            "pattern": "^(0|6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})$"
                          }
                        ]
                      },
                      "default": [],
                      "minItems": 0
                    }
                  }
                }
              },
              {
                "if": {
                  "properties": {
                    "protocol": {
                      "type": "string",
                      "pattern": "^(ALL|ICMP|ESP|AH|SCTP|IPIP)$"
                    }
                  },
                  "required": [
                    "protocol"
                  ]
                },
                "then": {
                  "type": "object",
                  "title": "Other Named Protocol Rule",
                  "additionalProperties": false,
                  "required": [
                    "protocol"
                  ],
                  "properties": {
                    "protocol": {
                      "title": "IP Protocol",
                      "description": "The IP protocol to which this rule applies. The value can be TCP, UDP, ICMP, or ALL.",
                      "type": "string",
                      "widget": "Select",
                      "enum": [
                        "ALL",
                        "AH",
                        "ESP",
                        "ICMP",
                        "IPIP",
                        "SCTP",
                        "TCP",
                        "UDP"
                      ],
                      "default": "TCP",
                      "examples": [
                        "TCP",
                        "UDP",
                        "ICMP"
                      ]
                    },
                    "ports": {
                      "type": "array",
                      "widget": "GenericList",
                      "items": {
                        "type": "string",
                        "deleteOnEmpty": true,
                        "maxLength": 0,
                        "pattern": "^(?!.*)"
                      },
                      "maxItems": 0
                    }
                  }
                }
              }
            ]
          },
          "examples": [
            {
              "protocol": "TCP",
              "ports": [
                "80",
                "443"
              ]
            }
          ]
        },
        "other_protocols_rule": {
          "type": "object",
          "title": "Other Named Protocol Rule",
          "additionalProperties": false,
          "required": [
            "protocol"
          ],
          "properties": {
            "protocol": {
              "title": "IP Protocol",
              "description": "The IP protocol to which this rule applies. The value can be TCP, UDP, ICMP, or ALL.",
              "type": "string",
              "widget": "Select",
              "enum": [
                "ALL",
                "AH",
                "ESP",
                "ICMP",
                "IPIP",
                "SCTP",
                "TCP",
                "UDP"
              ],
              "default": "TCP",
              "examples": [
                "TCP",
                "UDP",
                "ICMP"
              ]
            },
            "ports": {
              "type": "array",
              "widget": "GenericList",
              "items": {
                "type": "string",
                "deleteOnEmpty": true,
                "maxLength": 0,
                "pattern": "^(?!.*)"
              },
              "maxItems": 0
            }
          }
        },
        "tcp_udp_rule": {
          "type": "object",
          "title": "TCP/UDP Rule",
          "additionalProperties": false,
          "properties": {
            "protocol": {
              "title": "IP Protocol",
              "description": "The IP protocol to which this rule applies. The value can be TCP, UDP, ICMP, or ALL.",
              "type": "string",
              "widget": "Select",
              "enum": [
                "ALL",
                "AH",
                "ESP",
                "ICMP",
                "IPIP",
                "SCTP",
                "TCP",
                "UDP"
              ],
              "default": "TCP",
              "examples": [
                "TCP",
                "UDP",
                "ICMP"
              ]
            },
            "ports": {
              "title": "Ports",
              "type": "array",
              "widget": "GenericList",
              "items": {
                "type": "string",
                "oneOf": [
                  {
                    "title": "Port Range",
                    "pattern": "^(0|6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})-(6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})$"
                  },
                  {
                    "title": "Port",
                    "pattern": "^(0|6[0-5][0-5][0-3][0-5]|[1-5][0-9][0-9][0-9][0-9]|[1-9][0-9]{0,3})$"
                  }
                ]
              },
              "default": [],
              "minItems": 0
            }
          }
        },
        "service_account": {
          "title": "Service Account",
          "description": "The email address of a service account. Firewall rules can target or be applied based on service accounts.",
          "type": "string",
          "pattern": "^\\S+@\\S+\\.\\S+$",
          "maxLength": 63,
          "examples": [
            "project-number-compute@developer.gserviceaccount.com",
            "project-id@appspot.gserviceaccount.com",
            "project-number@cloudservices.gserviceaccount.com"
          ]
        },
        "sources": {
          "title": "Sources",
          "type": "array",
          "description": "List of source specifications for the firewall rule. Can be an IP CIDR range, a tag, or a service account email.",
          "widget": "GenericList",
          "items": {
            "type": "string",
            "oneOf": [
              {
                "title": "IP CIDR Range",
                "type": "string",
                "description": "IP space allocated to this subnetwork in CIDR format.",
                "examples": [
                  "192.168.0.0/24"
                ],
                "pattern": "^(?:([0-9]|[1-9][0-9]{0,1}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5])(\\.([0-9]|[1-9][0-9]{0,1}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5])){3}/(([0-9]|[1-2][0-9]|3[0-2])))$"
              },
              {
                "title": "Tag",
                "type": "string",
                "description": "Strings added to a tags field in a resource, such as Compute Engine virtual machine (VM) instances or instance templates. Tags enable you to make firewall rules and routes applicable to specific VM instances.",
                "pattern": "^(?:[a-z](?:[-a-z0-9]{0,61}[a-z0-9])?)$",
                "maxLength": 63,
                "examples": [
                  "alpha-tag",
                  "bravo-tag",
                  "charlie-tag",
                  "web-server",
                  "database"
                ]
              },
              {
                "title": "Service Account",
                "description": "The email address of a service account. Firewall rules can target or be applied based on service accounts.",
                "type": "string",
                "pattern": "^\\S+@\\S+\\.\\S+$",
                "maxLength": 63,
                "examples": [
                  "project-number-compute@developer.gserviceaccount.com",
                  "project-id@appspot.gserviceaccount.com",
                  "project-number@cloudservices.gserviceaccount.com"
                ]
              }
            ]
          },
          "default": [],
          "minItems": 0,
          "examples": [
            "192.168.1.0/24",
            "example-tag",
            "example-service-account@example.com"
          ]
        },
        "tag": {
          "title": "Tag",
          "type": "string",
          "description": "Strings added to a tags field in a resource, such as Compute Engine virtual machine (VM) instances or instance templates. Tags enable you to make firewall rules and routes applicable to specific VM instances.",
          "pattern": "^(?:[a-z](?:[-a-z0-9]{0,61}[a-z0-9])?)$",
          "maxLength": 63,
          "examples": [
            "alpha-tag",
            "bravo-tag",
            "charlie-tag",
            "web-server",
            "database"
          ]
        },
        "targets": {
          "title": "Targets",
          "type": "array",
          "description": "List of target specifications for the firewall rule. Can be an IP CIDR range, a tag, or a service account email.",
          "widget": "GenericList",
          "items": {
            "type": "string",
            "oneOf": [
              {
                "title": "IP CIDR Range",
                "type": "string",
                "description": "IP space allocated to this subnetwork in CIDR format.",
                "examples": [
                  "192.168.0.0/24"
                ],
                "pattern": "^(?:([0-9]|[1-9][0-9]{0,1}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5])(\\.([0-9]|[1-9][0-9]{0,1}|1[0-9]{1,2}|2[0-4][0-9]|25[0-5])){3}/(([0-9]|[1-2][0-9]|3[0-2])))$"
              },
              {
                "title": "Tag",
                "type": "string",
                "description": "Strings added to a tags field in a resource, such as Compute Engine virtual machine (VM) instances or instance templates. Tags enable you to make firewall rules and routes applicable to specific VM instances.",
                "pattern": "^(?:[a-z](?:[-a-z0-9]{0,61}[a-z0-9])?)$",
                "maxLength": 63,
                "examples": [
                  "alpha-tag",
                  "bravo-tag",
                  "charlie-tag",
                  "web-server",
                  "database"
                ]
              },
              {
                "title": "Service Account",
                "description": "The email address of a service account. Firewall rules can target or be applied based on service accounts.",
                "type": "string",
                "pattern": "^\\S+@\\S+\\.\\S+$",
                "maxLength": 63,
                "examples": [
                  "project-number-compute@developer.gserviceaccount.com",
                  "project-id@appspot.gserviceaccount.com",
                  "project-number@cloudservices.gserviceaccount.com"
                ]
              }
            ]
          },
          "default": [],
          "minItems": 0,
          "examples": [
            "192.168.1.0/24",
            "example-tag",
            "example-service-account@example.com"
          ]
        }
      }
    }
  }
}
